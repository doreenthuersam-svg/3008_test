<!--- üî• DEIN KONFIGURATOR - 100% FUNKTIONIEREND mit allen Fixes --->
<div class="fahrzeug-konfigurator">

<!-- HERO (bleibt gleich) -->
<img src="PEUGEOTE-3008.jpg" class="hero-image" style="width:100%; height:400px; object-fit:cover; border-radius:15px; margin-bottom:30px;">

<section class="hero">
<h1>Peugeot 3008 Hybrid Gewerbe-Leasing</h1>
<p>Ohne √úberf√ºhrungskosten | Lieferzeit 5-6 Monate</p>
<div class="varianten-grid">
<div class="variante-card active" data-variante="preisknaller">
<h3>üí∞ Preisknaller</h3>
<div class="rate">ab <strong>98,53 ‚Ç¨</strong></div>
<small>Allure Basis</small>
</div>
<div class="variante-card" data-variante="topseller">
<h3>‚≠ê Topseller</h3>
<div class="rate">ab <strong>110,72 ‚Ç¨</strong></div>
<small>Allure Business</small>
</div>
<div class="variante-card" data-variante="powerpaket">
<h3>‚ö° Powerpaket</h3>
<div class="rate">ab <strong>139,48 ‚Ç¨</strong></div>
<small>GT Premium</small>
</div>
</div>
</section>

<!-- KONFIGURATOR MIT FARBEN -->
<section class="konfigurator">
<h2 id="aktuelle-variante">Preisknaller Allure</h2>

<!-- Leasing Auswahl MIT FARBEN -->
<div class="leasing-grid">
<div class="input-group">
<label>Laufzeit</label>
<select id="laufzeit">
<option value="24">24 Monate</option>
<option value="36" selected>36 Monate</option>
<option value="48">48 Monate</option>
</select>
</div>
<div class="input-group">
<label>km/Jahr</label>
<select id="km">
<option value="10000">10.000 km</option>
<option value="15000">15.000 km</option>
<option value="20000">20.000 km</option>
<option value="25000">25.000 km</option>
</select>
</div>

<!-- üî• NEU: FARBWAHL -->
<div class="input-group">
<label>Farbe (Aufpreis)</label>
<select id="farbe">
<option value="0">Obsession Blau (inklusive)</option>
<option value="650">Okenite Wei√ü (+650 ‚Ç¨)</option>
<option value="650">Ingrao Blau (+650 ‚Ç¨)</option>
<option value="650">Artens Grau (+650 ‚Ç¨)</option>
<option value="850">Perla Nera Schwarz (+850 ‚Ç¨)</option>
<option value="850">Titan Grau (+850 ‚Ç¨)</option>
</select>
</div>

<div class="input-group">
<label>WuV</label>
<select id="wuv">
<option value="ohne">Ohne WuV</option>
<option value="mit">Mit WuV (+√úberschlag)</option>
</select>
</div>
<!-- ‚úÖ FIX: ID ge√§ndert von "anhaenger" zu "anhaenger-leasing" -->
<div class="input-group">
<label>Anh√§ngerkupplung</label>
<select id="anhaenger-leasing">
<option value="0">Nein (0 ‚Ç¨)</option>
<option value="10">Ja (+10 ‚Ç¨)</option>
</select>
</div>
</div>

<!-- AUSSTATTUNG (ID angepasst) -->
<div class="ausstattung">
<h3>Optionale Ausstattung</h3>
<label class="checkbox-option">
<input type="checkbox" data-preis="2500" id="gtline"> GT-Line Paket (+2.500 ‚Ç¨)
</label>
<label class="checkbox-option">
<input type="checkbox" data-preis="1200" id="panorama"> Panorama-Dach (+1.200 ‚Ç¨)
</label>
<label class="checkbox-option">
<input type="checkbox" data-preis="800" id="sitzheizung"> Sitzheizung vorn (+800 ‚Ç¨)
</label>
<!-- ‚úÖ FIX: ID von "anhaenger" zu "anhaenger-extra" ge√§ndert -->
<label class="checkbox-option">
<input type="checkbox" data-preis="800" id="anhaenger-extra">
  Anh√§ngerkupplung (+800 ‚Ç¨)
</label>
</div>

<!-- GESAMTRATE -->
<div class="ergebnis">
<div class="monatsrate">Ihre Rate:</div>
<div class="gro√üe-rate" id="gesamt-rate">98,53 ‚Ç¨</div>
<div class="small">netto zzgl. MwSt. pro Monat</div>
</div>
</section>

<!-- KONTAKT (unver√§ndert) -->
<section class="kontakt">
<h3>Angebot anfragen</h3>
<p>Nach Versand erhalten Sie Ihre personalisierte Selbstauskunft</p>

<div class="form-grid">
<input type="text" id="firma" placeholder="Firma *" required>
<input type="text" id="ansprechpartner" placeholder="Ansprechpartner *">
<input type="email" id="email" placeholder="E-Mail *" required>
<input type="tel" id="telefon" placeholder="Telefon">
<textarea id="nachricht" placeholder="Weitere W√ºnsche (optional)"></textarea>
</div>

<button onclick="anfrageAbschicken()" class="cta-button">Angebot sichern</button>
</section>

</div>

<script>
const preismatrix = {
  preisknaller: {
    24: {10000: 105.20, 15000: 128.50, 20000: 157.80, 25000: 181.90},
    36: {10000: 98.53, 15000: 120.83, 20000: 149.87, 25000: 172.60},
    48: {10000: 92.40, 15000: 113.70, 20000: 141.20, 25000: 163.50}
  },
  topseller: {
    24: {10000: 115.80, 15000: 139.20, 20000: 168.50, 25000: 192.70},
    36: {10000: 110.72, 15000: 132.92, 20000: 161.87, 25000: 184.50},
    48: {10000: 104.60, 15000: 125.80, 20000: 153.20, 25000: 175.40}
  },
  powerpaket: {
    24: {10000: 145.30, 15000: 168.70, 20000: 197.90, 25000: 222.10},
    36: {10000: 139.48, 15000: 161.58, 20000: 190.47, 25000: 213.10},
    48: {10000: 133.20, 15000: 154.30, 20000: 181.70, 25000: 203.80}
  }
};

const wuvPreise = {24: 41.05, 36: 41.05, 48: 38.90};

let konfiguration = {
  variante: 'preisknaller',
  laufzeit: 36,
  km: 10000,
  wuv: 'ohne',
  farbe: 0,
  anhaengerLeasing: 0,  // ‚úÖ FIX: Neue Property
  gtline: false,
  panorama: false,
  sitzheizung: false,
  anhaengerExtra: false  // ‚úÖ FIX: Neue Property
};

// ‚úÖ FIX: KOMPLETT √úBERARBEITETE berechneGesamt() Funktion
function berechneGesamt() {
  const basisrate = preismatrix[konfiguration.variante][konfiguration.laufzeit][konfiguration.km];
  const wuvZuschlag = konfiguration.wuv === 'mit' ? wuvPreise[konfiguration.laufzeit] : 0;
  
  const farbeMonatlich = konfiguration.farbe / konfiguration.laufzeit;
  const wuvUeberschlag = (konfiguration.wuv === 'mit' && konfiguration.farbe > 0)
    ? konfiguration.farbe / konfiguration.laufzeit
    : 0;

  // ‚úÖ FIX: Korrekte Anh√§ngerkupplung-Behandlung
  const anhaengerMonatlich = parseFloat(konfiguration.anhaengerLeasing) || 0;
  
  let extrasumme = 0;
  if (konfiguration.gtline) extrasumme += 2500 / konfiguration.laufzeit;
  if (konfiguration.panorama) extrasumme += 1200 / konfiguration.laufzeit;
  if (konfiguration.sitzheizung) extrasumme += 800 / konfiguration.laufzeit;
  if (konfiguration.anhaengerExtra) extrasumme += 800 / konfiguration.laufzeit;  // ‚úÖ FIX: Korrekter Preis

  const gesamt = basisrate + wuvZuschlag + farbeMonatlich + wuvUeberschlag + anhaengerMonatlich + extrasumme;

  const out = document.getElementById('gesamt-rate');
  if (out) out.textContent = gesamt.toFixed(2).replace('.', ',') + ' ‚Ç¨';

  // Debug-Info (optional)
  console.log(`Basis:${basisrate.toFixed(2)} WuV:${wuvZuschlag.toFixed(2)} Farbe:${farbeMonatlich.toFixed(2)} W√ú:${wuvUeberschlag.toFixed(2)} Anh.Leasing:${anhaengerMonatlich.toFixed(2)} Extras:${extrasumme.toFixed(2)} = ${gesamt.toFixed(2)}`);
}

// ‚úÖ VARIANTE-CARDS (unver√§ndert)
document.querySelectorAll('.variante-card').forEach((card, index) => {
  card.addEventListener('click', function() {
    document.querySelectorAll('.variante-card').forEach(c => c.classList.remove('active'));
    this.classList.add('active');

    konfiguration.variante = this.dataset.variante;
    document.getElementById('aktuelle-variante').textContent =
      index === 0 ? 'Preisknaller Allure' :
      index === 1 ? 'Topseller Allure Business' : 'Powerpaket GT Premium';

    berechneGesamt();
  });
});

// ‚úÖ ALLE EVENT LISTENER - KOMPLETT FIX
document.getElementById('laufzeit').addEventListener('change', function() {
  konfiguration.laufzeit = parseInt(this.value, 10);
  berechneGesamt();
});

document.getElementById('km').addEventListener('change', function() {
  konfiguration.km = parseInt(this.value, 10);
  berechneGesamt();
});

document.getElementById('wuv').addEventListener('change', function() {
  konfiguration.wuv = this.value;
  berechneGesamt();
});

// ‚úÖ FIX: Korrekte Select-ID
document.getElementById('anhaenger-leasing').addEventListener('change', function() {
  konfiguration.anhaengerLeasing = parseFloat(this.value);
  berechneGesamt();
});

document.getElementById('farbe').addEventListener('change', function() {
  konfiguration.farbe = parseFloat(this.value);
  berechneGesamt();
});

// Checkbox-Listener
document.getElementById('gtline').addEventListener('change', function() {
  konfiguration.gtline = this.checked;
  berechneGesamt();
});

document.getElementById('panorama').addEventListener('change', function() {
  konfiguration.panorama = this.checked;
  berechneGesamt();
});

document.getElementById('sitzheizung').addEventListener('change', function() {
  konfiguration.sitzheizung = this.checked;
  berechneGesamt();
});

// ‚úÖ FIX: Korrekte Checkbox-ID
document.getElementById('anhaenger-extra').addEventListener('change', function() {
  konfiguration.anhaengerExtra = this.checked;
  berechneGesamt();
});

// START
berechneGesamt();

function anfrageAbschicken() {
  const daten = {
    fahrzeug: 'Peugeot 3008 Hybrid',
    konfiguration,
    kontakt: {
      firma: document.getElementById('firma').value,
      ansprechpartner: document.getElementById('ansprechpartner').value,
      email: document.getElementById('email').value,
      telefon: document.getElementById('telefon').value,
      nachricht: document.getElementById('nachricht').value
    }
  };
  localStorage.setItem('leasing-anfrage', JSON.stringify(daten));
  alert('‚úÖ Anfrage gespeichert! Rate: ' + document.getElementById('gesamt-rate').textContent);
}
</script>

<!-- CSS bleibt IDENTISCH -->
<style>
.fahrzeug-konfigurator { max-width: 800px; margin: 0 auto; padding: 20px; font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
.hero { text-align: center; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 40px 20px; border-radius: 20px; margin-bottom: 30px; }
.hero h1 { color: #1a1a1a; margin: 0 0 10px; font-size: 2.2em; }
.hero p { color: #666; margin: 0 0 30px; font-size: 1.1em; }
.varianten-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; }
.variante-card { padding: 25px; background: white; border-radius: 15px; cursor: pointer; transition: all 0.3s; border: 3px solid transparent; }
.variante-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
.variante-card.active { border-color: #007cba; background: linear-gradient(135deg, #007cba15 0%, #007cba30 100%); }
.variante-card h3 { margin: 0 0 10px; font-size: 1.3em; }
.rate { font-size: 1.8em; color: #007cba; margin: 10px 0; }
.konfigurator, .kontakt { background: white; padding: 30px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
.konfigurator h2, .kontakt h3 { color: #1a1a1a; margin-top: 0; }
.leasing-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin: 30px 0; }
.input-group { display: flex; flex-direction: column; }
.input-group label { font-weight: 600; margin-bottom: 8px; color: #333; }
select { padding: 12px 15px; border: 2px solid #e1e5e9; border-radius: 10px; font-size: 16px; background: white; }
.ausstattung { margin: 30px 0; }
.checkbox-option { display: block; padding: 15px; border: 2px solid #f0f0f0; border-radius: 10px; margin-bottom: 10px; cursor: pointer; transition: all 0.3s; }
.checkbox-option:hover { border-color: #007cba; background: #f8fbff; }
.checkbox-option input:checked ~ span { color: #007cba; font-weight: bold; }
.ergebnis { text-align: center; padding: 30px; background: linear-gradient(135deg, #007cba15 0%, #41a6f5 100%); border-radius: 20px; margin: 30px 0; }
.gro√üe-rate { font-size: 3.5em; font-weight: 800; color: #007cba; margin: 10px 0; text-shadow: 2px 2px 4px rgba(0,124,186,0.2); }
.monatsrate { font-size: 1.3em; color: #666; margin-bottom: 5px; }
.small { color: #888; font-size: 0.9em; }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
input, textarea { padding: 15px; border: 2px solid #e1e5e9; border-radius: 10px; font-size: 16px; transition: border-color 0.3s; }
input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: #007cba;
  box-shadow: 0 0 0 3px rgba(0,124,186,0.15);
}
textarea { min-height: 120px; resize: vertical; }
.cta-button {
  width: 100%;
  padding: 16px 18px;
  border: none;
  border-radius: 12px;
  background: #007cba;
  color: #fff;
  font-size: 18px;
  font-weight: 700;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
}
.cta-button:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 20px rgba(0,0,0,0.12);
  opacity: 0.95;
}
.cta-button:active {
  transform: translateY(0);
  box-shadow: 0 6px 14px rgba(0,0,0,0.10);
}
@media (max-width: 600px) {
  .form-grid { grid-template-columns: 1fr; }
  .gro√üe-rate { font-size: 2.6em; }
}
</style>
